<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/sparkjs/0.5.9/spark.min.js"></script>
    <script src="notify.js"></script>
    <link rel="icon" type="image/png" href="playdog.ico">
    <title>PlayDog</title>
</head>

<body>
    <script src="playdog.js"></script>
    
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="/">PlayDog Control</a>
                <button type="button" class="btn btn-default navbar-btn" data-toggle="modal" data-target="#loginModal">Particle.io Login</button>
            </div>
        </div>
    </nav>
    
    <div class="container-fluid">
        
        
        <div class="alert alert-info" role="alert" id="alert" style="display: none;"></div>
        
    	<div class="row">
    	    
            
    		<div class="col-md-6">
    		    <div class="panel panel-default">
    					<div class="panel-heading">
    						<h3 class="panel-title">
    							Actions
    						</h3>
    					</div>
    					<div class="panel-body" id="actions-body">
    					    
    						<div class="panel-group">
      						<div class="panel panel-default">
          						<div class="panel-heading">
          						    <a class="panel-title collapsed" data-toggle="collapse" data-parent="#panel-actions-help" href="#panel-actions-help-content">Help <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span></a>
          						</div>
          						<div id="panel-actions-help-content" class="panel-collapse collapse">
              						<div class="panel-body">
              						    <h3>Step 1: Familiarization</h3>
                              Before using the device, make sure your dog is not afraid of PlayDog.
                              If your pet is fearful, keep the device unplugged for a few days, 
                              give it a treat and create a good atmosphere around the device.
                              <br>
                              
                              <h3>Step 2: Introduction</h3>
                              Using the Dispese is the first step in your journey with PlayDog.
                              The home base (feeding base) gives 'free food' to your dog in order to train it to get its food from the PlayDog home base.
                              Move to the next stage (teach) after a day or two, when you see that your dog feels comfortable with the home base.
                              If you see that the dog is afraid of the home base, go back to familiarization.
                              
                              <h3>Step 3: Teaching</h3>
                              This game will teach the dog the essence of PlayDog - when a base makes a noise,
                              the dog should come and get food. It works on the principle of classic conditioning 
                              with positive reinforcement and assumes the dog is already trained to come when the
                              home base dispenses food.
                              <br>
                              The home base gives the dog 'free food' once, then waits for the dog to arrive.
                              When the dog arrives it plays the 'come' cue and dispenses again.
                              If the dog doesn't arrive after the time defined as maximum time per base the game is declared failed.
                              <br>
                              The goal is to teach the dog the connection between the beep and the reward. 
                              Move to the next stage (practice) after 1-3 days, if your dog successfully accomplishes most games (70% success rate).
                              <br>
                              
                              <h3>Step 4: Practicing</h3>
                              The Single Base Game completes your training. The home base plays the 'come' cue and afterwards starts beeping. 
                              The dog has a limited amount of time to arrive and get the food. Otherwise, the dog "fails" the game.
                              <br>
                              Move to the next stage(Remote Calling Base) after 2-5 days, if your dog successfully accomplishes most games (70% success rate).
                              If your dog fails after 3-5 days to cross the 50% success rate line, consider going back to the 
                              Teach stage for a few more days.
                              <br>
                              
                              <h3>Step 5: Remote Calling Base</h3>
                              Double Base Game involves additional bases on top of the home (feeding) base, and familiarizes
                              your pet with the other bases in the PlayDog system. A random calling base calls the dog, after it has
                              already learnt to come to the 'come cue'. If your dog already understood PlayDog, it should come to 
                              the calling base (with some hesitation, and not on the first try). The moment the calling base sees
                              your pet near, the home (feeding) base will start calling the dog and reward it with a food portion.
                              <br>
                              Move to the next (and final) stage after 3-10 days when your dog passes the 60% success rate mark.
                              <br>
                              <h3>Step 6: Triple Base Game</h3>
                              
                              This is the final PlayDog mode, where all the bases (calling bases and feeding base) are involved, 
                              making your dog run around and enjoy.
                              <br>
                              Base order is a randomized path and calling bases are called one by one. The last base is always the 
                              home base that rewards the dog if the dog arrived at all the bases on time.
                              <br>
                              You can make the game more complex by shortening the time to base parameter.
              						</div>
          						</div>
      		        </div>
    		        </div>
                <button class="btn btn-primary btn-block btn-lg" type="button" onclick = "dispenseBtn()" data-toggle="tooltip" title="Dispense single portion">Dispense</button><br>
                <button class="btn btn-primary btn-block btn-lg" type="button" onclick = "teachBtn()"    data-toggle="tooltip" title="Teach the come sound">Teach</button><br>
                <button class="btn btn-primary btn-block btn-lg" type="button" onclick = "singleBtn()"   data-toggle="tooltip" title="Game with only the homebase">Single Base Game</button><br>
                <button class="btn btn-primary btn-block btn-lg" type="button" onclick = "doubleBtn()"   data-toggle="tooltip" title="Game with one base and one homebase">Double Base Game</button><br>
                <button class="btn btn-primary btn-block btn-lg" type="button" onclick = "tripleBtn()"   data-toggle="tooltip" title="Game with two bases and one homebase">Triple Base Game</button><br>
                <h3><div id="gameResult"></div></h3>
		          </div>
    		    </div>
				
    		</div>
    		<div class="col-md-6">
		      <div class="panel panel-default">
					  <div class="panel-heading">
				      <a class="panel-title">Options</a>
					  </div>
					  <div id="panel-params-content" class="panel-collapse">
  					  <div class="panel-body" id="params-body">
  						    <div class="input-group">
                      <span class="input-group-addon" id="basic-addon3">Time to bases (secs)</span>
                      <input type="text" class="form-control" id="inputTimeout" aria-describedby="basic-addon3" value="10">
                      <span class="input-group-btn">
                      <button class="btn btn-default" type="button" onclick="updateTimeout()">Update</button>
                      </span>
                  </div>
                  <br>
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Device Name</th>
                        <th>Device ID</th>
                        <th>Device Type</th>
                      </tr>
                    </thead>
                    <tbody id="devices">
                    </tbody>
                  </table>
                  
                  <div class="row">
                    <div class="col-md-6">
                      <button class="btn btn-info    btn-block btn-lg" type="button" data-toggle="modal" data-target="#addDeviceModal">Add Device</button><br>
                    </div>
                    <div class="col-md-6">
                      <button class="btn btn-info    btn-block btn-lg" type="button" onclick = "refreshDevices()">Refresh Devices</button><br>
                    </div>
                  </div>
  						</div>
  					</div>
  		    </div>
    		    
			
			
    		</div>
    	</div>

    </div>
    
    <div class="modal fade" id="deviceModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="deviceModalTitle">Modal title</h4>
          </div>
          <div class="modal-body">
            <button type="button" class="btn btn-default" onclick="testPIRBtn()">Test PIR</button>
            <button type="button" class="btn btn-default" onclick="flashOptionsBtn()"  >Flash</button>
            <br>
            <br>
            <div class="well" id='flashOptions'>
              <div class="input-group">
                  <span class="input-group-addon" id="basic-addon3">Firmware URL</span>
                  <input type="text" class="form-control" id="flashURL" aria-describedby="basic-addon3" value='https://raw.githubusercontent.com/Roboplan/Playdog/master/fw/'>
                  <span class="input-group-btn">
                  <button class="btn btn-default" type="button" onclick="flashBtn()">Begin</button>
                  </span>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="modal fade" id="addDeviceModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Adding Devices</h4>
          </div>
          <div class="modal-body">
            To add a device, first pair your device using <a href="https://docs.particle.io/guide/getting-started/start/photon/#connect-your-photon">these instructions</a>.
            <br>
            Once your device is connected to the cloud, click refresh devices, and you should see it listed in the devices table. 
            Otherwise, make sure it is on-line and that you are using the same credentials when logging in on this page, and when 
            setting up the Photons.
            Click on it's name to flash it with the lastest Playdog firmware.
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    
    
    <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <a href="//particle.io"><h4 class="modal-title" id="myModalLabel">Particle.io Login</h4></a>
          </div>
          <div class="modal-body">
                Playdog is powered by Particle.io's photon modules. <br>Please enter your particle's login details to continue.<br>
                <br>
                <div class="alert alert-danger" role="alert" id="loginModalError" style="display: none;">Error Message</div>
                <div class="input-group">
                <span class="input-group-addon" id="basic-addon3">Email</span>
                <input type="text" class="form-control" id="spark-email" aria-describedby="basic-addon3">
                </div>
                <div class="input-group">
                <span class="input-group-addon" id="basic-addon3">Password</span>
                <input type="password" class="form-control" id="spark-password" aria-describedby="basic-addon3">
                </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" onclick="doLogin()">Login</button>
          </div>
        </div>
      </div>
    </div>

  <script>
  $(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip(); 
  });
  </script>    
</body>
</html>